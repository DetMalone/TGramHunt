@page
@using TGramHunt.Helpers
@using TGramHunt.Services.Helpers
@model TGramHunt.Pages.EditProfile.IndexModel

@{
    var urlHelper = new CustomUrlHelper(Url);
    var userAvatarLink = LinkHelper.ImageRelativLink(Model?.Profile?.PictureIdx100,
        Model?.Profile?.PictureCache ?? 0,
        Model?.Profile?.Picture);
}

<div id="profile">

    <div class="container-lg">
        <div class="d-flex flex-column">
            <h2 class="fw-bold">Edit Profile</h2>
            <div class="d-flex flex-row editprofile-image-block">
                <div class="profile_avatar text-center col-4">
                    @if (!string.IsNullOrWhiteSpace(userAvatarLink))
                    {
                        <img src="@userAvatarLink" width="100" height="100" class="rounded-circle article-img" />
                    }
                    else
                    {
                        <img src="" width="100" height="100" class="rounded-circle article-img d-none" />
                        <i class="fas fa-camera color-grey"></i>
                    }
                </div>

                <div class="flex-column align-self-center text-center">
                    <button id="btnGetImage" class="btn profile-file-upload">Upload a new picture</button>
                    <input class="d-none" type="file" id="fileUpload" accept=".jpg, .jpeg, .png, .gif" />
                </div>
            </div>

            <form id="edit-profile-form" method="post" novalidate>
                @Html.AntiForgeryToken()
                <div class="flex-row h-100 mt-5 mw-100">
                    <div class="row">
                        <div class="col-md mt-4">
                            <label class="edit-profile-label">Name</label>
                            <div class="input-group">
                                <input type="text"
                                       class="form-control error"
                                       name="name"
                                       id="name"
                                       placeholder="Enter name"
                                       autocomplete="off"
                                       value="@Model?.Profile?.Name" />
                            </div>
                            <label class="error text-center"
                                   for="name"
                                   style="display:none;"></label>
                        </div>
                        <div class="col-md mt-4">
                            <label class="edit-profile-label">Telegram username</label>
                            <div class="input-group">
                                <input type="text"
                                       class="form-control"
                                       name="telegramUserName"
                                       id="telegramUserName"
                                       autocomplete="off"
                                       readonly="readonly" value="@("@" + Model?.Profile?.TelegramUserName)" />
                            </div>
                            <label class="error text-center"
                                   for="telegramUserName"
                                   style="display:none;"></label>
                        </div>
                    </div>
                </div>
                <div class="row p-3">
                    <div class="col-md-8 themed-grid-col">
                        <div class="row">
                            <label class="error" for="total" style="display:none"></label>
                        </div>
                    </div>
                </div>
            </form>
        </div>
        <hr />
        <div class="row p-md-3">
            <div class="col align-self-start">
                <div class="row save-cancel-container">
                    <button type="button" class="btn profile-save-btn">Save</button>
                    <a href="@urlHelper.ProfileIndex()" class="btn profile-cancel-btn" role="button">Cancel</a>
                </div>
            </div>

            <div class="col align-self-end text-end">
                <button type="button" class="btn profile-close-btn">Close Account</button>
            </div>
        </div>
    </div>
    <hr />
</div>

<div class="modal fade" id="croppmodal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">

            <div class="modal-header">
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <div id="imgModal-msg" class="modal-body mb-2">

                <div id="cropped-img-wrp">
                    <img id="cropped-img" />
                </div>

                <div id="imgModal-cropme-wrp" class="justify-content-center">
                    <div id="imgModal-cropme" class=""></div>
                </div>
            </div>
            <div class="modal-footer justify-content-center">
                <button id="imgModal-btnSave" class="btn profile-save-btn">Save Image</button>
                <button id="imgModal-btnCrop" type="button" class="btn profile-save-btn">Crop</button>
            </div>
        </div>
    </div>
</div>
<input id="profile-link-redirect" value="@urlHelper.ProfileIndex()" />

<div class="modal fade" id="modal-info-profile" tabindex="-1" role="dialog" aria-labelledby="signup" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div id="modalBody">
            </div>
        </div>
    </div>
</div>
<template id="close-btn-dialog-body-1">
    <div class="modal-body mb-2">
        <p>Are you sure you want to close your account?</p>
        <div class="modal-footer">
            <button class="btn profile-save-btn" data-bs-dismiss="modal">Cancel</button>
            <button class="btn profile-save-btn" id="profile-close-btn-first">Yes</button>
        </div>
    </div>
</template>
<template id="close-btn-dialog-body-2">
    <div class="modal-body mb-2">
        <p>Are you sure you want to delete all your data from the site?</p>
        <div class="modal-footer">
            <button class="btn profile-save-btn" data-bs-dismiss="modal">Cancel</button>
            <button class="btn profile-save-btn" id="profile-close-btn-second">Yes</button>
        </div>
    </div>
</template>
<template id="invalid-type-dialog">
    <div class="modal-body mb-2">
        <p>Please select the correct format. Acceptable formats jpeg, jpg, png, gif.</p>
        <p class="invalid-type-dialog-message"></p>
        <div class="modal-footer">
            <button class="btn profile-save-btn" data-bs-dismiss="modal">Ok</button>
        </div>
    </div>
</template>
<template id="alert-dialog">
    <div class="modal-body mb-2">
        <p class="alert-dialog-class"></p>
        <div class="modal-footer">
            <button class="btn profile-save-btn"
                    data-bs-dismiss="modal">
                Ok
            </button>
        </div>
    </div>
</template>